* [磁盘结构](#磁盘结构)
* [磁盘调度算法](#磁盘调度算法)
	* [先来先服务](#先来先服务)
	* [最短寻道时间优先算法](#最短寻道时间优先算法)
	* [电梯算法](#电梯算法)
	* [循环扫描算法](#循环扫描算法)
	* [平均寻道距离](#平均寻道距离)

# 磁盘结构

- 盘面：一个磁盘有多个盘面
- 磁道：盘面上的圆形带状区域，一个盘面可以有多个磁道
- 扇区：磁道上的一个弧段，一个磁道可以有多个扇区，它是最小的物理储存单位，目前主要有 512 bytes 与 4 K 两种大小
- 磁头：与盘面非常接近，能够将盘面上的磁场转换为电信号（读），或者将电信号转换为盘面的磁场（写）
- 制动手臂：用于在磁道之间移动磁头
- 主轴：使整个盘面转动

# 磁盘调度算法

读写一个磁盘所需时间的影响因素

- 旋转时间
- 寻道时间
- 实际数据传输时间

其中寻道时间最长，因此磁盘调度主要是为了使得磁盘的平均寻道时间最短

磁盘访问时间计算

已知某磁盘的平均转速是 r 秒/转，平均寻找时间是 T 秒，每个磁道可以存储的字节数是 N，现在向该磁盘写入 b 字节的数据，采用随机寻道的方法，每道的所有扇区组成一个簇，其平均访问时间 t
$$
t=(r+T)*b/N
$$


## 先来先服务

按照磁盘请求的顺序进行调度

优点是公平和简单，缺点也很明显，因为未对寻道做任何优化，这样使得平均寻道时间可能更长

## 最短寻道时间优先算法

优先调度与当前磁头所在磁道距离最近的磁道

虽然这样做平均寻道时间比较低，但是不够公平，如果新达到的磁道请求总是比一个在等待的磁道请求近，那么在等待的磁道请求会一直等待下去，也就是出现饥饿现象，具体来说，两端的磁道请求更容易出现饥饿现象

## 电梯算法

电梯总是保持向一个方向运行，知道该方向没有请求为止，然后改变运行方向

电梯算法和电梯的运行过程类似，总是按照一个方向进行磁盘调度，直到该方向上没有未完成的磁道请求，然后改变防线

因为考虑了移动方向，因此所有的磁盘请求都会被满足，解决了最短寻道时间优先算法产生的饥饿问题，但还是会出现两侧磁道的访问频率低于中间磁道

## 循环扫描算法

在磁道访问请求均匀的情况下，对于电梯算法，当磁头到达磁盘的一段并且进行反向扫描时，落在磁头后面的磁道请求相对较少，由于这些磁道请求刚被上一轮处理过，而磁盘的另一端请求密度相当高，且这些请求等待时间长，为了解决这种问题引入循环扫描算法

循环扫描算法规定磁头单向运动，例如磁头自里向外运动，当磁头移动到最外的被访问的磁道时，磁头立即返回到最里的欲访问磁道，即最小磁道号紧接着最大磁道号构成循环，进行扫描

## 平均寻道距离

若磁头的当前位置在第 100 磁道，现在有一磁盘读写请求序列如下：23,376,205,132,19,61,190,398,29,4,18,40。若采用最短寻道时间优先算法，则平均寻道长度是多少？

- 先来先服务

该算法只考虑访问请求的先后顺序。如上题当前位置为100，则顺序为(100)，23，376，205，132，19，61，190，398，29，4，18，40，因此磁头移动磁道总数为(100-23)+(376-23)+(376-205)+ (205-132)+(132-19)+(61-19)+(190-61)+(398-190)+(398-29)+(29-4)+(18-4)+(40-18) = 1596，平均移动磁道数为1596/12 =133.0；

- 最短寻道时间优先算法

从等待的访问者中挑选寻找时间最短的那个请求执行。如上题当前位置为100，则顺序为(100)，132，190，205，61，40，29，23，19，18，4，376，398，因此磁头移动磁道总数为(132-100)+(190-132)+(205-190)+(205-61)+(61-40)+(40-29)+(29-23)+(23-19)+(19-18)+(18-4)+(376-4)+(398-376)=700，平均移动磁道数为700/12 =58.3；

- 电梯算法

按当前位置找出最近的那个数，当前位置指向最近数决定方向，依次排列数字，排到尽头,再按当位置和最近数的相反方面依次排列数字。如上题当前位置为100，则顺序为(100)，132，190，205，376，398，61，40，29，23，19，18，4，因此磁头移动磁道总数为(132-100)+(190-132)+(205-190)+(376-205)+(398-376)+(398-61)+(61-40)+(40-29)+(29-23)+(23-19)+(19-18)+(18-4)=692，平均移动磁道数为692/12 =57.7；

- 循环扫描算法

由当前位置到从小到大排列数字，再将剩下的数由小到大排。如上题当前位置为100，则顺序为(100)，132，190，205，376，398，4，18，19，23，29，40，61，因此磁头移动磁道总数为(132-100)+(190-132)+(205-190)+(376-205)+(398-376)+(398-4)+(18-4)+(19-18)+(23-19)+(29-23)+(40-29)+(61-40)=749，平均移动磁道数为749/12 =62.4;